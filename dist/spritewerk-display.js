var SW={};
SW.Util=function(){"use strict";var r=function(){};return r.prototype.clone=function(r){var t,n="object"==typeof r&&r.hasOwnProperty("length")?[]:{};for(t in r)n[t]="object"==typeof r[t]&&null!==r[t]?this.clone(r[t]):r[t];return n},r.prototype.mixin=function(r){var t,n,o=arguments.length;if(2>o)throw new Error("Util.mixin requires two or more arguments");for(var e=1;o>e;e+=1){t=this.clone(arguments[e]);for(n in t)r[n]=t[n]}return r},r.prototype.hasMembers=function(r){var t=0;for(var n in r)if(t++,t)break;return t?!0:!1},r.prototype.hitPoint=function(r,t,n){var o=n.position(),e=n.dimensions();return r>=o.x&&r<=o.x+e.x&&t>=o.y&&t<=o.y+e.y?!0:!1},new r}();
SW.Unique=function(){"use strict";var i=0,n=function(){this._uid=++i};return n}();
SW.Collection=function(){"use strict";var t=function(){SW.Unique.call(this),this._items=[]};return t.prototype=SW.Util.clone(SW.Unique.prototype),t.prototype.addItem=function(t,e){return this._items.push({name:t,value:e}),this},t.prototype.addItemAt=function(t,e,i){return this._items.splice(i,0,{name:t,value:e}),this},t.prototype.removeItem=function(t){this._rawEach(function(e,i,n,o){return t===n?(e=null,o.splice(i,1),!1):void 0})},t.prototype.removeAllItems=function(){return this._items=[],this},t.prototype.each=function(t,e){var i;t=e?t.bind(e):t;for(var n=0,o=this._items.length;o>n&&(i=this._items[n],t(i.value,n,i.name)!==!1);n+=1);},t.prototype._rawEach=function(t){for(var e=0,i=this._items.length;i>e&&t(this._items[e],e,this._items[e].name,this._items)!==!1;e+=1);},t.prototype.filter=function(t,e){var i,n=[];return this.each(function(e,o,r){i=t(e,o,r),i&&n.push(i)},e),n},t.prototype.getItemCount=function(){return this._items.length},t.prototype.setItem=function(t,e){return this._rawEach(function(i,n,o){return t===o?(i.value=e,!1):void 0}),this},t.prototype.getItem=function(t){var e;return this.each(function(i,n,o){return t===o?(e=i,!1):void 0}),e},t.prototype.getItemAt=function(t){return this._items[t].value},t.prototype._getRawItem=function(t){var e;return this._rawEach(function(i,n,o){return t===o?(e=i,!1):void 0}),e},t.prototype.setItemIndex=function(t,e){var i,n=this.getItemIndex(t);e!==n&&(i=this._getRawItem(t),this.removeItem(t),this._items.splice(e,0,i))},t.prototype.getItemIndex=function(t){var e;return this.each(function(i,n,o){return t===o?(e=n,!1):void 0}),e},t}();
SW.Dom=function(){"use strict";var i=function(){SW.Signal.addListener(window,"resize",this._onWindowResize,this),SW.Signal.addListener(window,"orientationchange",this._onWindowResize,this)};return i.prototype._onWindowResize=function(){SW.Signal.dispatch("screen/resize")},i}();
SW.Canvas=function(){"use strict";var t=function(t){this._canvasEl=document.getElementById(t.id),this._context=this._canvasEl.getContext("2d"),this._width=t.width,this._height=t.height,this._canvasEl.width=this._width,this._canvasEl.height=this._height,this._canvasEl.style.position="absolute",t.canvasFit&&(SW.Signal.addListener("screen/resize",this._onScreenResize,this),this._onScreenResize())};return t.prototype._onScreenResize=function(){var t,e,i=this._height/this._width,n=this._width/this._height,s=n>i?!0:!1,o=window.innerWidth,h=window.innerHeight,r=h/o,a=o/h,c=0,l=0;s?r>i?(t=o,e=t*i,l=(h-e)/2):(e=h,t=h*n,c=(o-t)/2):a>n?(e=h,t=h*n,c=(o-t)/2):(t=o,e=t*i,l=(h-e)/2),this._canvasEl.style.width=Math.round(t)+"px",this._canvasEl.style.height=Math.round(e)+"px",this._canvasEl.style.left=Math.round(c)+"px",this._canvasEl.style.top=Math.round(l)+"px"},t.prototype.clearAll=function(){return this._context.clearRect(0,0,this._width,this._height),this},t.prototype.fillAll=function(t){return this._context.save(),this._context.fillStyle=t,this._context.fillRect(0,0,this._width,this._height),this._context.restore(),this},t.prototype.render=function(t){var e=t.position(),i=t.scale(),n=t.rotationOffset(),s=t.scaleOffset();switch(this._context.save(),this._context.translate(Math.floor(e.x),Math.floor(e.y)),0!==t.rotation()&&(this._context.translate(n.x,n.y),this._context.rotate(Math.PI/180*t.gsRotation()),this._context.translate(-n.x,-n.y)),(1!==t.scaleX||1!==t.scaleY)&&(this._context.translate(s.x,s.y),this._context.scale(i.x,i.y),this._context.translate(-s.x,-s.y)),this._context.globalAlpha=t.opacity(),this._context.globalCompositeOperation=t.composite(),t.getDisplayType()){case"rectangle":this.renderRectangle(t);break;case"line":this.renderLine(t);break;case"sprite":this.renderSprite(t);break;case"text":this.renderText(t);break;default:throw new Error("SW.Canvas cannot render type: "+t.getDisplayType())}this._context.restore()},t.prototype.renderRectangle=function(t){var e=t.dimensions(),i=t.fillStyle(),n=t.strokeStyle();this._context.save(),this._context.fillStyle=i,this._context.strokeStyle=n,this._context.lineWidth=t.strokeWidth(),i&&this._context.fillRect(0,0,e.x,e.y),n&&this._context.strokeRect(0,0,e.x,e.y),this._context.restore()},t.prototype.renderLine=function(t){var e=t.coordinates();this._context.save(),this._context.strokeStyle=t.strokeStyle(),this._context.lineWidth=t.strokeWidth(),this._context.beginPath(),this._context.moveTo(e[0].x,e[0].y);for(var i=1,n=e.length;n>i;i+=1)this._context.lineTo(e[i].x,e[i].y);this._context.stroke(),this._context.restore()},t.prototype.renderText=function(t){var e=t.fillStyle(),i=t.strokeStyle();this._context.save(),this._context.font=t.font(),this._context.textBaseline=t.baseline(),this._context.textAlign=t.align(),this._context.lineWidth=t.strokeWidth(),this._context.fillStyle=e,this._context.strokeStyle=i,e&&this._context.fillText(t.contents(),0,0),i&&this._context.strokeText(t.contents(),0,0),this._context.restore()},t.prototype.renderSprite=function(t){var e=t.dimensions(),i=t.srcDimensions(),n=t.srcPosition();this._context.drawImage(t.image(),n.x,n.y,i.x,i.y,0,0,e.x,e.y)},t.prototype.getCanvasEl=function(){return this._canvasEl},t.prototype.getContext=function(){return this._context},t}();
SW.Vector=function(){"use strict";var t=function(t,e){this.x="number"==typeof t?t:0,this.y="number"==typeof e?e:0};return t}();
SW.Renderable=function(){"use strict";var t=function(){SW.Unique.call(this),this._position=new SW.Vector,this._velocity=new SW.Vector,this._dimensions=new SW.Vector,this._scale=new SW.Vector(1,1),this._rotationOffset=new SW.Vector,this._scaleOffset=new SW.Vector,this._draggable=!1,this._rotation=0,this._opacity=1,this._fillStyle="#999",this._strokeStyle="#000",this._strokeWidth=4,this._visible=!0,this._hidden=!1,this._composite="source-over",this._displayType=""};return t.prototype=SW.Util.clone(SW.Unique.prototype),t.prototype.getDisplayType=function(){return this._displayType},t.prototype.position=function(t,i){return void 0===t&&void 0===i?this._position:("number"==typeof t&&(this._position.x=t),"number"==typeof i&&(this._position.y=i),this)},t.prototype.dimensions=function(t,i){return void 0===t&&void 0===i?this._dimensions:("number"==typeof t&&(this._dimensions.x=t),"number"==typeof i&&(this._dimensions.y=i),this)},t.prototype.rotation=function(t){return void 0===t?this._rotation:("number"==typeof t&&(this._rotation=t),this)},t.prototype.rotationOffset=function(t,i){return void 0===t&&void 0===i?this._rotationOffset:("number"==typeof t&&(this._rotationOffset.x=t),"number"==typeof i&&(this._rotationOffset.y=i),this)},t.prototype.scale=function(t,i){return void 0===t&&void 0===i?this._scale:("number"==typeof t&&(this._scale.x=t),"number"==typeof i&&(this._scale.y=i),this)},t.prototype.scaleOffset=function(t,i){return void 0===t&&void 0===i?this._scale:("number"==typeof t&&(this._scaleOffset.x=t),"number"==typeof i&&(this._scaleOffset.y=i),this)},t.prototype.draggable=function(t){return void 0===t?this._draggable:("boolean"==typeof t&&(this._draggable=t),this)},t.prototype.opacity=function(t){return void 0===t?this._opacity:("number"==typeof t&&(this._opacity=t),this)},t.prototype.composite=function(t){return void 0===t?this._composite:("number"==typeof t&&(this._composite=t),this)},t.prototype.fillStyle=function(t){return void 0===t?this._fillStyle:("string"==typeof t&&(this._fillStyle=t),this)},t.prototype.strokeStyle=function(t){return void 0===t?this._strokeStyle:("string"==typeof t&&(this._strokeStyle=t),this)},t.prototype.strokeWidth=function(t){return void 0===t?this._strokeWidth:("number"==typeof t&&(this._strokeWidth=t),this)},t.prototype.getOuterPosition=function(){return new SW.Vector(this._position.x+this._dimensions.x,this._position.y+this._dimensions.y)},t.prototype.getCenterPosition=function(){return new SW.Vector(this._position.x-this._dimensions.x/2,this._position.y-this._dimensions.y/2)},t.prototype.getHalfDimension=function(){return new SW.Vector(this._dimensions.x/2,this._dimensions.y/2)},t}();
SW.Rectangle=function(){"use strict";var e=function(){SW.Renderable.call(this),this._displayType="rectangle"};return e.prototype=SW.Util.clone(SW.Renderable.prototype),e}();
SW.Line=function(){"use strict";var t=function(){SW.Renderable.call(this),this._coordinates=[],this._width=1,this._cap="butt",this._displayType="line"};return t.prototype=SW.Util.clone(SW.Renderable.prototype),t.prototype.coordinates=function(){if(!arguments.length)return this._coordinates;for(var t=0,e=arguments.length;e>t;t+=1)this._coordinates[t]=arguments[t];return this},t}();
SW.Sprite=function(){"use strict";var i=function(){SW.Renderable.call(this),this._image=null,this._srcPosition=new SW.Vector,this._srcDimensions=new SW.Vector,this._displayType="sprite"};return i.prototype=SW.Util.clone(SW.Renderable.prototype),i.prototype.srcPosition=function(i,s){return void 0===i&&void 0===s?this._srcPosition:("number"==typeof i&&(this._srcPosition.x=i),"number"==typeof s&&(this._srcPosition.y=s),this)},i.prototype.srcDimensions=function(i,s){return void 0===i&&void 0===s?this._srcDimensions:("number"==typeof i&&(this._srcDimensions.x=i),"number"==typeof s&&(this._srcDimensions.y=s),this)},i.prototype.image=function(i){return void 0===i?this._image:("object"==typeof i&&(this._image=i,this._srcDimensions.x||this._srcDimensions.y||(this._srcDimensions.x=this._image.width,this._srcDimensions.y=this._image.height),this._dimensions.x||this._dimensions.y||(this._dimensions.x=this._image.width,this._dimensions.y=this._image.height)),this)},i}();