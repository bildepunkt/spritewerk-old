<!DOCTYPE html>
<html>
<head>
    <title>spritewerk events &amp; display</title>

    <script src="../src/spritewerk.js"></script>

    <script src="../src/common/util.js"></script>
    <script src="../src/common/unique.js"></script>
    <script src="../src/common/collection.js"></script>

    <script src="../src/events/signal.js"></script>
    <script src="../src/events/input.js"></script>

    <script src="../src/display/vector.js"></script>
    <script src="../src/display/canvas.js"></script>
    <script src="../src/display/renderable.js"></script>
    <script src="../src/display/sprite.js"></script>
    <script src="../src/display/line.js"></script>
    <script src="../src/display/rectangle.js"></script>
    <script src="../src/display/polygon.js"></script>
    <script src="../src/display/text.js"></script>

    <script>
        function loadHandler() {
            var collection;
            var rectangle;
            var input;
            var canvas;
            var text;

            SW.Signal.removeListener(window, 'load', loadHandler);

            SW.Signal.addListener('press', function(e) {
                console.log(e.type, e.detail.target);
            });
            SW.Signal.addListener('pressup', function(e) {
                console.log(e.type, e.detail.target);
            });
            SW.Signal.addListener('pressdown', function(e) {
                console.log(e.type, e.detail.target);
            });
            SW.Signal.addListener('dblpress', function(e) {
                console.log(e.type, e.detail.target);
            });
            SW.Signal.addListener('pressleave', function(e) {
                console.log(e.type, e.detail.target);
            });
            SW.Signal.addListener('dragstart', function(e) {
                console.log(e.type, e.detail.target);
            });
            SW.Signal.addListener('drag', function(e) {
                console.log(e.type, e.detail.target);
            });
            SW.Signal.addListener('dragend', function(e) {
                console.log(e.type, e.detail.target);
            });
            SW.Signal.addListener('dragleave', function(e) {
                console.log(e.type, e.detail.target);
            });

            canvas = new SW.Canvas({
                id: 'spritewerk',
                width: 600,
                height: 400
            });

            input = new SW.Input({
                eventEl: canvas.getCanvasEl(),
                bindMouseInput: true,
                bindTouchInput: true
            });

            collection = new SW.Collection();

            text = new SW.Text({
                contents: 'lorem ipsum dolor sit amet lorem ipsum dolor sit amet lorem ipsum dolor sit amet'
            })
                .draggable(true)
                .font('24px sans-serif')
                .strokeWidth(2)
                .maxWidth(230)
                .rotation(-15);
            collection.addItem('text', text);

            rectangle = new SW.Rectangle()
                .dimensions(128, 128)
                .draggable(true)
                .fillStyle('#000')
                .composite('source-out');
            collection.addItem('recto', rectangle);

            rectangle = new SW.Rectangle()
                .position(null, 128)
                .dimensions(128, 128)
                .fillStyle('#C4C')
                .opacity(0.5);
            collection.addItem('recto2', rectangle);

            // can be collection
            input.setLayer(collection);

            function renderAll() {
                canvas.clearAll();
                collection.each(function(entity) {
                    canvas.render(entity);
                });
            }

            setInterval(function() {
                requestAnimationFrame(renderAll);
            }, 33);
        }

        SW.Signal.addListener(window, 'load', loadHandler);
    </script>
</head>
<body>
    <canvas id="spritewerk"></canvas>
</body>
</html>
